import marshal,zlib,base64
exec(base64.b64decode("aW1wb3J0IHJlcXVlc3RzLGpzb24sdGltZSxzeXMscmFuZG9tLG9zLGFyZ3BhcnNlDQppbXBvcnQgY29sb3JhbWENCmZyb20gY29sb3JhbWEgaW1wb3J0IEZvcmUsIEJhY2ssIFN0eWxlDQpmcm9tIHJhbmRvbSBpbXBvcnQgcmFuZGludA0KZnJvbSBkYXRldGltZSBpbXBvcnQgZGF0ZXRpbWUNCmNvbG9yYW1hLmluaXQoYXV0b3Jlc2V0PVRydWUpDQoNCg0KDQpwYXJzZXIgPSBhcmdwYXJzZS5Bcmd1bWVudFBhcnNlcihkZXNjcmlwdGlvbj0nOTk5IERpY2UgQm90IHwgVGhpcyBJcyBHYW1ibGluZyBCb3QgUGxhc2UgVGFrZSBPd24gWW91ciBSaXNrJykNCnBhcnNlci5hZGRfYXJndW1lbnQoDQogICAgJy1jJywnLS1iZXRzZXQnLA0KICAgIGRlZmF1bHQ9MCwNCiAgICBoZWxwPSdFbnRlciBZb3VyIEJldHNldCBOdW1iZXIgKGRlZmF1bHQ6IDApJw0KKQ0KbXlfbmFtZXNwYWNlID0gcGFyc2VyLnBhcnNlX2FyZ3MoKQ0KDQoNCg0KDQoNCndpdGggb3BlbignY29uZmlnLmpzb24nLCAncicpIGFzIG15ZmlsZToNCiAgICAgIGRhdGE9bXlmaWxlLnJlYWQoKQ0KIyBwYXJzZSBmaWxlDQpvYmogPSBqc29uLmxvYWRzKGRhdGEpDQoNCg0KcHJpbnQgKFN0eWxlLk5PUk1BTCtGb3JlLk1BR0VOVEErIlxudC5tZS91YmlpZFxuIitTdHlsZS5OT1JNQUwrRm9yZS5HUkVFTisiXG49PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiIrU3R5bGUuQlJJR0hUK0ZvcmUuR1JFRU4rIkF1dGhvciBCeSAgIitTdHlsZS5ESU0rRm9yZS5XSElURSsiOiAiK1N0eWxlLlJFU0VUX0FMTCsiQm9tb2hUZXJtdXhcbiIrU3R5bGUuQlJJR0hUK0ZvcmUuR1JFRU4rIkNoYW5uZWwgWW91VHViZSAiK1N0eWxlLk5PUk1BTCtGb3JlLldISVRFKyI6IitTdHlsZS5SRVNFVF9BTEwrIiBCb21vaCBUZXJtdXggIitTdHlsZS5CUklHSFQrRm9yZS5HUkVFTisiXG45OTlEaWNlLmNvbSBCT1QiK1N0eWxlLk5PUk1BTCtGb3JlLldISVRFKyIgfCAiK1N0eWxlLkJSSUdIVCtGb3JlLlJFRCsiIEpJV0EgSEFSVVMgS0VOVEFMTEwgIitTdHlsZS5OT1JNQUwrRm9yZS5XSElURSsifCIrU3R5bGUuQlJJR0hUK0ZvcmUuR1JFRU4rIiBLQUxBSCBjdWJhIExBR0kuLi5cbiIrU3R5bGUuQlJJR0hUK0ZvcmUuR1JFRU4rInN1cHBvcnQgYnkgaHR0cHM6Ly9naXRodWIuY29tL01vbmtleUQtY29yZS85OTlcbiIrU3R5bGUuQlJJR0hUK0ZvcmUuR1JFRU4rIkRvbmF0ZSAiK1N0eWxlLk5PUk1BTCtGb3JlLldISVRFKyI6IitTdHlsZS5CUklHSFQrRm9yZS5HUkVFTisiIEJUQyAiK1N0eWxlLlJFU0VUX0FMTCsiM0h1Y3g4Qm5EV1NSWVVqYnI0VndQOWtjb2Y2S1dxVWJZTFxuIitTdHlsZS5CUklHSFQrRm9yZS5HUkVFTisiICAgICAgICAgTFRDICIrU3R5bGUuUkVTRVRfQUxMKyJMaFNwUmZ5ZEx3dHIxdXV1YWkxYzNudXo5dk05d3lhVzJNXG4iK1N0eWxlLkJSSUdIVCtGb3JlLkdSRUVOKyIgICAgICAgICBEb2dlICIrU3R5bGUuUkVTRVRfQUxMKyJENlZTTk11VnpjWW9tS2JkSk1CcWpLaUtBa1VSZjNmcDdHXG5cbiIpDQoNCmhpamF1ID0gU3R5bGUuQlJJR0hUK0ZvcmUuR1JFRU4NCg0KcmVzID0gU3R5bGUuUkVTRVRfQUxMDQphYnUyID0gU3R5bGUuTk9STUFMK0ZvcmUuV0hJVEUNCnVuZ3UgPSBTdHlsZS5OT1JNQUwrRm9yZS5NQUdFTlRBDQpoaWphdTIgPSBTdHlsZS5OT1JNQUwrRm9yZS5HUkVFTg0KcmVkMiA9IFN0eWxlLk5PUk1BTCtGb3JlLlJFRA0KcmVkID0gU3R5bGUuQlJJR0hUK0ZvcmUuUkVEDQpjID0gcmVxdWVzdHMuc2Vzc2lvbigpDQoNCnVybCA9ICJodHRwczovL3d3dy45OTlkb2dlLmNvbS9hcGkvd2ViLmFzcHgiDQp1YSA9IHsNCiAiT3JpZ2luIjogImZpbGU6Ly8iLA0KICJ1c2VyLWFnZW50Ijogb2JqWyJVc2VyLUFnZW50Il0sDQogIkNvbnRlbnQtdHlwZSI6ICJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQiLA0KICJBY2NlcHQiOiAiKi8qIiwNCiAiQWNjZXB0LUxhbmd1YWdlIjogImlkLUlELGlkO3E9MC45LGVuLVVTO3E9MC44LGVuO3E9MC43IiwNCiAiWC1SZXF1ZXN0ZWQtV2l0aCI6ICJjb20ucmVsYW5kLnJlbGFuZGljZWJvdCINCn0NCg0KZGVmIGtvbnZlcnQocGVyc2VuLHRhcnVoYW4pOg0KICAgIGdsb2JhbCBoaWdoDQogICAgZ2xvYmFsIGxvdw0KICAgIGMgPSBzdHIoOTk5OTk5ICogZmxvYXQocGVyc2VuKSAvIDEwMCkNCiAgICBpZiB0YXJ1aGFuID09ICJIaSIgb3IgdGFydWhhbiA9PSAiaGkiIG9yIHRhcnVoYW4gPT0gIkhJIjoNCiAgICAgICBuID0gc3RyKGMuc3BsaXQoIi4iKVsxXSkNCiAgICAgICBwYW5na2F0ID0gNiAtIGxlbihuKQ0KICAgICAgIGxvdyA9IGludChpbnQobikgKiAoMTAgKiogcGFuZ2thdCkpDQogICAgICAgaGlnaCA9IDk5OTk5OQ0KICAgIGlmIHRhcnVoYW4gPT0gIkxvIiBvciB0YXJ1aGFuID09ICJMT1ciIG9yIHRhcnVoYW4gPT0gImxvdyIgb3IgdGFydWhhbiA9PSAiTG93IiBvciB0YXJ1aGFuID09ICJMTyI6DQogICAgICAgbG93ID0gMA0KICAgICAgIGhpZ2ggPSBpbnQoYy5zcGxpdCgiLiIpWzBdKQ0KDQoNCmRlZiByZXYobnVtKToNCiAgICBpZiAobGVuKG51bSkgPCA4KToNCiAgICAgICAgcGFuamFuZ19ub2wgPSBpbnQoOCAtIGxlbihudW0pKQ0KICAgICAgICBudW0gPSAoKHBhbmphbmdfbm9sKiIwIikrc3RyKG51bSkpDQogICAgICAgIHJlc3VsdCA9ICgiMC4iK251bSkNCiAgICBpZiAobGVuKG51bSkgPT0gOCk6DQogICAgICAgIHBhbmphbmdfbm9sID0gaW50KDggLSBsZW4obnVtKSkNCiAgICAgICAgbnVtID0gKChwYW5qYW5nX25vbCoiMCIpK3N0cihudW0pKQ0KICAgICAgICByZXN1bHQgPSAoIjAuIitudW0pDQogICAgZWxzZToNCiAgICAgICAgbGVuX251bSA9IGxlbihudW0pDQogICAgICAgIGVuZCA9IG51bVstODpdDQogICAgICAgIGZpcnN0ID0gbnVtWzpsZW5fbnVtLThdDQogICAgICAgIHJlc3VsdCA9IChmaXJzdCsiLiIrZW5kKQ0KICAgIHJldHVybiAocmVzdWx0KQ0KDQoNCg0KZGVmIGRpY2Uod3MsbHMpOg0KICAgaWYgbXlfbmFtZXNwYWNlLmJldHNldCA9PSAiQXV0byIgb3IgbXlfbmFtZXNwYWNlLmJldHNldCA9PSAiYXV0byIgb3IgbXlfbmFtZXNwYWNlLmJldHNldCA9PSAiQVVUTyI6DQogICAgICB1cnV0ID0gMA0KICAgICAganVtbGFodWxhbmc9IDANCiAgICAgIHdoaWxlIFRydWU6DQogICAgICAgICBqdW1sYWh1bGFuZys9MQ0KICAgICAgICAgdHJ5Og0KICAgICAgICAgICAgIHBlc2FuID0gb2JqWyJDb25maWciXVtqdW1sYWh1bGFuZ11bIk5hbWUgQmV0IFNldCJdDQogICAgICAgICBleGNlcHQ6DQogICAgICAgICAgICAgYnJlYWsNCiAgIGVsc2U6DQogICAgICB1cnV0ID0gaW50KG15X25hbWVzcGFjZS5iZXRzZXQpDQoNCiAgIHNscCA9IGludChvYmpbIkNvbmZpZyJdW3VydXRdWyJJbnRlcnZhbCJdKSAvIDEwMDANCiAgIGxpbWl0X2EgPSBpbnQob2JqWyJDb25maWciXVt1cnV0XVsiUmVzZXQgSWYgV2luIl0pIC0gMQ0KICAgcGF5aW4gPSBpbnQoZmxvYXQob2JqWyJDb25maWciXVt1cnV0XVsiQmFzZSBCZXQiXSkqKDEwICoqIDgpKQ0KICAga29udmVydChvYmpbIkNvbmZpZyJdW3VydXRdWyJDaGFuY2UiXSxvYmpbIkNvbmZpZyJdW3VydXRdWyJCZXQiXVsiQmV0Il0pDQogICBhbW91bnQgPSBwYXlpbg0KICAgZGF0YSA9IHsNCiAgICAgICJhIjogIlBsYWNlQmV0IiwNCiAgICAgICJzIjoganNbIlNlc3Npb25Db29raWUiXSwNCiAgICAgICJQYXlJbiI6IGFtb3VudCwNCiAgICAgICJMb3ciOiBsb3csDQogICAgICAiSGlnaCI6IGhpZ2gsDQogICAgICAiQ2xpZW50U2VlZCI6IHJhbmRpbnQoMCw5OTk5OTkpLA0KICAgICAgIkN1cnJlbmN5IjogImRvZ2UiLA0KICAgICAgIlByb3RvY29sVmVyc2lvbiI6ICIyIg0KICAgfQ0KICAgdHJ5Og0KICAgICByMSA9IGMucG9zdCh1cmwsaGVhZGVycz11YSxkYXRhPWRhdGEpDQogICAgIGpzbiA9IGpzb24ubG9hZHMocjEudGV4dCkNCiAgICAganVtYmwgPSBqc25bIlN0YXJ0aW5nQmFsYW5jZSJdICsgaW50KGpzblsiUGF5T3V0Il0pIC0gaW50KGFtb3VudCkNCiAgICAganVtID0gaW50KGpzblsiUGF5T3V0Il0pIC0gaW50KGFtb3VudCkNCiAgICAgcHJvZiA9IChmbG9hdChqc25bIlN0YXJ0aW5nQmFsYW5jZSJdICsgaW50KGpzblsiUGF5T3V0Il0pIC0gaW50KGFtb3VudCkgLSBqdW1ibCkvKDEwICoqIDgpKQ0KICAgICBwcmludCAoaGlqYXUrIlxuXG5cblN0YXJ0aW5nIEJhbGFuY2UiLHJlcytzdHIoKGZsb2F0KGludChqc25bIlN0YXJ0aW5nQmFsYW5jZSJdKSArIGludChqdW0pKS8oMTAgKiogOCkpKSkNCiAgICAgcHJpbnQgKCJBbmRhIE1lbmdndW5ha2FuIEJldFNldCBLZSAiK29ialsiQ29uZmlnIl1bdXJ1dF1bIk5hbWUgQmV0IFNldCJdKQ0KICAgICBuID0gMA0KICAgICBidXJzdCA9IEZhbHNlDQogICAgIHN0YXRzX3JvbGViZXRfbG9zZSA9IEZhbHNlDQogICAgIHN0YXRzX3JvbGViZXRfd2luID0gRmFsc2UNCiAgICAgbWVuaXQgPSBkYXRldGltZS5ub3coKS5zdHJmdGltZSgnJU0nKQ0KICAgICBtZW5pdCA9IGludChtZW5pdCkgKyBpbnQob2JqWyJJbnRlcnZhbCJdKQ0KICAgICBub193aW4gPSAwDQogICAgIG5vX2xvc2UgPSAwDQogICAgIHRvdGFsX3dpbj0wDQogICAgIHRvdGFsX2xvc2U9MA0KICAgICBub19yb2xlYmV0ID0gMA0KICAgICByb2xlYmV0PSJIaSINCiAgICAgcmVzZXRfaWZfcHJvZml0ID0gb2JqWyJDb25maWciXVt1cnV0XVsiUmVzZXQgSWYgUHJvZml0Il0NCiAgICAgdG90X2lmX3Byb2ZpdCA9IG9ialsiQ29uZmlnIl1bdXJ1dF1bIlJlc2V0IElmIFByb2ZpdCJdDQogICAgIHdoaWxlIFRydWU6DQogICAgICAgIGlmIHJlc2V0X2lmX3Byb2ZpdCA9PSAiT0ZGIiBvciByZXNldF9pZl9wcm9maXQgPT0gIk9mZiIgb3IgcmVzZXRfaWZfcHJvZml0ID09ICJvZmYiOg0KICAgICAgICAgICBzdGF0c19pZl9wcm9maXQgPSBGYWxzZQ0KICAgICAgICBlbHNlOg0KICAgICAgICAgICBzdGF0c19pZl9wcm9maXQgPSBUcnVlDQogICAgICAgIGlmIG9ialsiQ29uZmlnIl1bdXJ1dF1bIk1heCBCZXQiXSA9PSAiT0ZGIiBvciBvYmpbIkNvbmZpZyJdW3VydXRdWyJNYXggQmV0Il0gPT0gIm9mZiIgb3Igb2JqWyJDb25maWciXVt1cnV0XVsiTWF4IEJldCJdID09ICJPZmYiOg0KICAgICAgICAgICAgc3lzLnN0ZG91dC53cml0ZSgiIikNCiAgICAgICAgZWxzZToNCiAgICAgICAgICAgaWYgYW1vdW50ID4gaW50KGZsb2F0KG9ialsiQ29uZmlnIl1bdXJ1dF1bIk1heCBCZXQiXSkqKDEwICoqIDgpKToNCiAgICAgICAgICAgICAgIGFtb3VudCA9IHBheWluDQogICAgICAgIGlmIG9ialsiQ29uZmlnIl1bdXJ1dF1bIkJldCJdWyJIaSAvIExvdyJdWyJUb2dnbGUiXSA9PSAiT24iIG9yIG9ialsiQ29uZmlnIl1bdXJ1dF1bIkJldCJdWyJIaSAvIExvdyJdWyJUb2dnbGUiXSA9PSAiT04iIG9yIG9ialsiQ29uZmlnIl1bdXJ1dF1bIkJldCJdWyJIaSAvIExvdyJdWyJUb2dnbGUiXSA9PSAib24iOg0KICAgICAgICAgICAgbm9fcm9sZWJldCArPTENCiAgICAgICAgICAgIGlmIHN0YXRzX3JvbGViZXRfd2luIGlzIFRydWU6DQogICAgICAgICAgICAgICBpZiBub19yb2xlYmV0ID4gaW50KG9ialsiQ29uZmlnIl1bdXJ1dF1bIkJldCJdWyJIaSAvIExvdyJdWyJJZiBXaW4iXSkgLSAxOg0KICAgICAgICAgICAgICAgICAgcm9sZWJldCA9ICJMbyINCiAgICAgICAgICAgICAgIGlmIG5vX3JvbGViZXQgPiBpbnQob2JqWyJDb25maWciXVt1cnV0XVsiQmV0Il1bIkhpIC8gTG93Il1bIklmIFdpbiJdKSAqIDIgLSAxOg0KICAgICAgICAgICAgICAgICAgcm9sZWJldCA9ICJIaSINCiAgICAgICAgICAgICAgICAgIG5vX3JvbGViZXQgPSAwDQogICAgICAgICAgICBpZiBzdGF0c19yb2xlYmV0X2xvc2UgaXMgVHJ1ZToNCiAgICAgICAgICAgICAgIGlmIG5vX3JvbGViZXQgPiBpbnQob2JqWyJDb25maWciXVt1cnV0XVsiQmV0Il1bIkhpIC8gTG93Il1bIklmIExvc2UiXSkgLTEgOg0KICAgICAgICAgICAgICAgICAgcm9sZWJldCA9ICJMbyINCiAgICAgICAgICAgICAgIGlmIG5vX3JvbGViZXQgPiBpbnQob2JqWyJDb25maWciXVt1cnV0XVsiQmV0Il1bIkhpIC8gTG93Il1bIklmIExvc2UiXSkgKiAyIC0gMToNCiAgICAgICAgICAgICAgICAgIHJvbGViZXQgPSAiSGkiDQogICAgICAgICAgICAgICAgICBub19yb2xlYmV0ID0gMA0KICAgICAgICBlbHNlOg0KICAgICAgICAgICAgcm9sZWJldCA9IG9ialsiQ29uZmlnIl1bdXJ1dF1bIkJldCJdWyJCZXQiXQ0KICAgICAgICBpZiBteV9uYW1lc3BhY2UuYmV0c2V0ID09ICJBdXRvIiBvciBteV9uYW1lc3BhY2UuYmV0c2V0ID09ICJBVVRPIiBvciBteV9uYW1lc3BhY2UuYmV0c2V0ID09ICJhdXRvIjoNCiAgICAgICAgICB3YWt0dSA9IGRhdGV0aW1lLm5vdygpLnN0cmZ0aW1lKCclTScpDQogICAgICAgICAgaWYgaW50KHdha3R1KSA+IGludChtZW5pdCAtIDEpOg0KICAgICAgICAgICAgIG1lbml0ID0gaW50KG1lbml0KSArIGludChvYmpbIkludGVydmFsIl0pDQogICAgICAgICAgICAgdXJ1dCArPTENCiAgICAgICAgICAgICBpZiB1cnV0ID09IGp1bWxhaHVsYW5nOg0KICAgICAgICAgICAgICAgIHVydXQgPSAwDQogICAgICAgICAgICAgcHJpbnQgKCJDaGFuZ2UgQmV0IFNldCAiK29ialsiQ29uZmlnIl1bdXJ1dF1bIk5hbWUgQmV0IFNldCJdKyIgICAgICAgICAgICAgICAgICAgICAgICAgICAiKQ0KICAgICAgICAgICAgIHNscCA9IGludChvYmpbIkNvbmZpZyJdW3VydXRdWyJJbnRlcnZhbCJdKSAvIDEwMDANCiAgICAgICAgICAgICBsaW1pdF9hID0gaW50KG9ialsiQ29uZmlnIl1bdXJ1dF1bIlJlc2V0IElmIFdpbiJdKSAtIDENCiAgICAgICAgICAgICBwYXlpbiA9IGludChmbG9hdChvYmpbIkNvbmZpZyJdW3VydXRdWyJCYXNlIEJldCJdKSooMTAgKiogOCkpDQogICAgICAgICAgICAgYW1vdW50ID0gcGF5aW4NCg0KICAgICAgICBlbHNlOg0KICAgICAgICAgIHVydXQgPSBpbnQobXlfbmFtZXNwYWNlLmJldHNldCkNCg0KICAgICAgICBpZiBvYmpbIkNvbmZpZyJdW3VydXRdWyJSYW5kb20gQ2hhbmNlIl1bIlRvZ2dsZSJdID09ICJPTiIgb3Igb2JqWyJDb25maWciXVt1cnV0XVsiUmFuZG9tIENoYW5jZSJdWyJUb2dnbGUiXSA9PSAiT24iIG9yIG9ialsiQ29uZmlnIl1bdXJ1dF1bIlJhbmRvbSBDaGFuY2UiXVsiVG9nZ2xlIl0gPT0gIm9uIjoNCiAgICAgICAgICAgaGFzaWxfY2hhbmNlID0gcm91bmQocmFuZG9tLnVuaWZvcm0oZmxvYXQob2JqWyJDb25maWciXVt1cnV0XVsiUmFuZG9tIENoYW5jZSJdWyJNaW4iXSksZmxvYXQob2JqWyJDb25maWciXVt1cnV0XVsiUmFuZG9tIENoYW5jZSJdWyJNYXgiXSkpLDIpDQogICAgICAgICAgIGNvayA9IGxlbihzdHIoaGFzaWxfY2hhbmNlKSkNCiAgICAgICAgICAgaWYgY29rID09IDM6DQogICAgICAgICAgICAgIHN5cy5zdGRvdXQud3JpdGUoIlxyIitzdHIoaGFzaWxfY2hhbmNlKSsiICAgIikNCiAgICAgICAgICAgaWYgY29rID09IDQ6DQogICAgICAgICAgICAgIHN5cy5zdGRvdXQud3JpdGUoIlxyIitzdHIoaGFzaWxfY2hhbmNlKSsiICAiKQ0KICAgICAgICAgICBpZiBjb2sgPT0gNToNCiAgICAgICAgICAgICAgc3lzLnN0ZG91dC53cml0ZSgiXHIiK3N0cihoYXNpbF9jaGFuY2UpKyIgIikNCiAgICAgICAgICAga29udmVydChoYXNpbF9jaGFuY2Usc3RyKHJvbGViZXQpKQ0KICAgICAgICBlbHNlOg0KICAgICAgICAgICBrb252ZXJ0KG9ialsiQ29uZmlnIl1bdXJ1dF1bIkNoYW5jZSJdLHN0cihyb2xlYmV0KSkNCg0KICAgICAgICB0aW1lLnNsZWVwKGZsb2F0KHNscCkpDQogICAgICAgIGFtb3VudCA9IGludChhbW91bnQpDQogICAgICAgIG4rPTENCiAgICAgICAgZGF0YSA9IHsNCiAgICAgICAgICAiYSI6ICJQbGFjZUJldCIsDQogICAgICAgICAgInMiOiBqc1siU2Vzc2lvbkNvb2tpZSJdLA0KICAgICAgICAgICJQYXlJbiI6IGFtb3VudCwNCiAgICAgICAgICAiTG93IjogbG93LA0KICAgICAgICAgICJIaWdoIjogaGlnaCwNCiAgICAgICAgICAiQ2xpZW50U2VlZCI6IHJhbmRpbnQoMCw5OTk5OTkpLA0KICAgICAgICAgICJDdXJyZW5jeSI6ICJkb2dlIiwNCiAgICAgICAgICAiUHJvdG9jb2xWZXJzaW9uIjogIjIiDQogICAgICAgIH0NCiAgICAgICAgaWYgcHJvZiA+IGZsb2F0KG9ialsiVGFyZ2V0IFByb2ZpdCJdKToNCiAgICAgICAgICAgcHJpbnQgKGhpamF1KyJcbllheS4hIFxuUHJvZml0IE1lbmNhcGFpIFRhcmdldC4uLi4uIVxuIitoaWphdSsiUHJvZml0ICIrcmVzK3N0cihwcm9mKSkNCiAgICAgICAgICAgb3Muc3lzdGVtKCJ0ZXJtdXgtdG9hc3QgWW91IHdpbiAiK3N0cihwcm9mKSkNCiAgICAgICAgICAgdGltZS5zbGVlcCgxKQ0KICAgICAgICAgICBvcy5zeXN0ZW0oInRlcm11eC10b2FzdCBUb3RhbCBCYWxhbmNlICIrc3RyKGZsb2F0KGludChqc25bIlN0YXJ0aW5nQmFsYW5jZSJdKSArIGludChqdW0pKS8oMTAgKiogOCkpKQ0KICAgICAgICAgICBzeXMuZXhpdCgpDQogICAgICAgIHIxID0gYy5wb3N0KHVybCxoZWFkZXJzPXVhLGRhdGE9ZGF0YSkNCiAgICAgICAganNuID0ganNvbi5sb2FkcyhyMS50ZXh0KQ0KICAgICAgICBwcm9mID0gKGZsb2F0KGpzblsiU3RhcnRpbmdCYWxhbmNlIl0gKyBpbnQoanNuWyJQYXlPdXQiXSkgLSBpbnQoYW1vdW50KSAtIGp1bWJsKS8oMTAgKiogOCkpDQogICAgICAgIGp1bSA9IGludChqc25bIlBheU91dCJdKSAtIGludChhbW91bnQpDQogICAgICAgIGlmIGpzblsiU3RhcnRpbmdCYWxhbmNlIl0gPiB3czoNCiAgICAgICAgICAgcHJpbnQgKHVuZ3UrIlsiK3JlcytzdHIocm9sZWJldCkrdW5ndSsiXSAiK2hpamF1MitzdHIoZmxvYXQoYW1vdW50KS8oMTAgKiogOCkpLHJlcytzdHIoZmxvYXQoaW50KGpzblsiU3RhcnRpbmdCYWxhbmNlIl0pICsgaW50KGp1bSkpLygxMCAqKiA4KSksaGlqYXUyKyJQcm9maXQiLHJlcytzdHIocHJvZikpDQogICAgICAgICAgIHByaW50IChoaWphdSsiWWF5LiFcbkJhbGFuY2UgU3VkYWggTWVtZW51aGkgVGFyZ2V0Li4uLi4hIikNCiAgICAgICAgICAgb3Muc3lzdGVtKCJ0ZXJtdXgtdG9hc3QgVGFyZ2V0IFdpbiBTdWRhaCBUZXJjYXBhaSIpDQogICAgICAgICAgIHRpbWUuc2xlZXAoMSkNCiAgICAgICAgICAgb3Muc3lzdGVtKCJ0ZXJtdXgtdG9hc3QgVG90YWwgQmFsYW5jZSAiK3N0cihmbG9hdChpbnQoanNuWyJTdGFydGluZ0JhbGFuY2UiXSkgKyBpbnQoanVtKSkvKDEwICoqIDgpKSkNCiAgICAgICAgICAgc3lzLmV4aXQoKQ0KICAgICAgICBpZiBqc25bIlN0YXJ0aW5nQmFsYW5jZSJdIDwgbHM6DQogICAgICAgICAgIHByaW50ICh1bmd1KyJbIityZXMrc3RyKHJvbGViZXQpK3VuZ3UrIl0iK3JlZDIrIi0iK3N0cihmbG9hdChhbW91bnQpLygxMCAqKiA4KSkscmVzK3N0cigoZmxvYXQoaW50KGpzblsiU3RhcnRpbmdCYWxhbmNlIl0pICsgaW50KGp1bSkpLygxMCAqKiA4KSkpLHJlZDIrIkxvc2UgIixyZXMrc3RyKHByb2YpKQ0KICAgICAgICAgICBwcmludCAoU3R5bGUuQlJJR0hUK0ZvcmUuUkVEKyJMb3NlIFRhcmdldC4uLi4hIikNCiAgICAgICAgICAgb3Muc3lzdGVtKCJ0ZXJtdXgtdG9hc3QgTG9zZSBUYXJnZXQgIikNCiAgICAgICAgICAgdGltZS5zbGVlcCgxKQ0KICAgICAgICAgICBvcy5zeXN0ZW0oInRlcm11eC10b2FzdCBUb3RhbCBCYWxhbmNlICIrc3RyKGZsb2F0KGludChqc25bIlN0YXJ0aW5nQmFsYW5jZSJdKSArIGludChqdW0pKS8oMTAgKiogOCkpKQ0KICAgICAgICAgICBzeXMuZXhpdCgpDQogICAgICAgIGlmIGpzblsiUGF5T3V0Il0gaXMgbm90IDA6DQogICAgICAgICAgIG5vX3dpbiArPTENCiAgICAgICAgICAgbm9fbG9zZSA9IDANCiAgICAgICAgICAgYmFsID0gaW50KGpzblsiU3RhcnRpbmdCYWxhbmNlIl0pICsgaW50KGp1bSkNCiAgICAgICAgICAgaWYgcHJvZiA+IDA6DQogICAgICAgICAgICAgcHJpbnQgKHVuZ3UrIlsiK3JlcytzdHIocm9sZWJldCkrdW5ndSsiXSAiK2hpamF1MitzdHIocmV2KHN0cihhbW91bnQpKSkscmVzK3N0cihyZXYoc3RyKGJhbCkpKSxoaWphdTIrIlByb2ZpdCIscmVzK3N0cihwcm9mKSkNCiAgICAgICAgICAgZWxzZToNCiAgICAgICAgICAgICBwcmludCAodW5ndSsiWyIrcmVzK3N0cihyb2xlYmV0KSt1bmd1KyJdICIraGlqYXUyK3N0cihyZXYoc3RyKGFtb3VudCkpKSxyZXMrc3RyKHJldihzdHIoYmFsKSkpLHJlZDIrIkxvc2UgIixyZXMrc3RyKHByb2YpKQ0KICAgICAgICAgICBhbW91bnQgPSBpbnQoYW1vdW50KSAqIGZsb2F0KG9ialsiQ29uZmlnIl1bdXJ1dF1bIklmIFdpbiJdKQ0KDQogICAgICAgIGVsc2U6DQogICAgICAgICAgIG5vX3dpbiA9IDANCiAgICAgICAgICAgbm9fbG9zZSArPTENCiAgICAgICAgICAgaSA9IDANCiAgICAgICAgICAgYnVyc3QgPSBUcnVlDQogICAgICAgICAgIGJhbCA9IGludChqc25bIlN0YXJ0aW5nQmFsYW5jZSJdKSArIGludChqdW0pDQogICAgICAgICAgIGlmIHByb2YgPiAwOg0KICAgICAgICAgICAgIHByaW50ICh1bmd1KyJbIityZXMrc3RyKHJvbGViZXQpK3VuZ3UrIl0iK3JlZDIrIi0iK3N0cihyZXYoc3RyKGFtb3VudCkpKSxyZXMrc3RyKHJldihzdHIoYmFsKSkpLGhpamF1MisiUHJvZml0IixyZXMrc3RyKHByb2YpKQ0KICAgICAgICAgICBlbHNlOg0KICAgICAgICAgICAgIHByaW50ICh1bmd1KyJbIityZXMrc3RyKHJvbGViZXQpK3VuZ3UrIl0iK3JlZDIrIi0iK3N0cihyZXYoc3RyKGFtb3VudCkpKSxyZXMrc3RyKHJldihzdHIoYmFsKSkpLHJlZDIrIkxvc2UgIixyZXMrc3RyKHByb2YpKQ0KICAgICAgICAgICBhbW91bnQgPSBpbnQoYW1vdW50KSAqIGZsb2F0KG9ialsiQ29uZmlnIl1bdXJ1dF1bIklmIExvc2UiXSkNCiAgICAgICAgaWYgc3RhdHNfaWZfcHJvZml0IGlzIFRydWU6DQogICAgICAgICAgICBpZiBwcm9mID4gZmxvYXQocmVzZXRfaWZfcHJvZml0KToNCiAgICAgICAgICAgICAgIGFtb3VudCA9IHBheWluDQogICAgICAgICAgICAgICByZXNldF9pZl9wcm9maXQgPSBmbG9hdChwcm9mKStmbG9hdCh0b3RfaWZfcHJvZml0KQ0KDQogICAgICAgIGlmIGJ1cnN0IGlzIFRydWU6DQogICAgICAgICAgIGkrPTENCiAgICAgICAgICAgaWYgaSA+IGxpbWl0X2E6DQogICAgICAgICAgICAgaSA9IDANCiAgICAgICAgICAgICBidXJzdCA9IEZhbHNlDQogICAgICAgIGVsc2U6DQogICAgICAgICAgIGlmIG4gPiBsaW1pdF9hOg0KICAgICAgICAgICAgIG4gPSAwDQogICAgICAgICAgICAgYW1vdW50ID0gcGF5aW4NCg0KICAgICAgICBpZiBub193aW4gPiB0b3RhbF93aW46DQogICAgICAgICAgIHN0YXRzX3JvbGViZXRfd2luID0gVHJ1ZQ0KICAgICAgICAgICBzdGF0c19yb2xlYmV0X2xvc2UgPSBGYWxzZQ0KICAgICAgICAgICB0b3RhbF93aW4gKz0xDQogICAgICAgIGlmIG5vX2xvc2UgPiB0b3RhbF9sb3NlOg0KICAgICAgICAgICBzdGF0c19yb2xlYmV0X2xvc2UgPSBUcnVlDQogICAgICAgICAgIHN0YXRzX3JvbGViZXRfd2luID0gRmFsc2UNCiAgICAgICAgICAgdG90YWxfbG9zZSArPTENCiAgICAgICAgc3lzLnN0ZG91dC53cml0ZShoaWphdSsiICAgICAgICBXaW4gU3RyZWFrICIrcmVzK3N0cih0b3RhbF93aW4pK3JlZCsiIExvc2UgU3RyZWFrICIrcmVzK3N0cih0b3RhbF9sb3NlKSsiXHIiKQ0KICAgICAgICBpZiBvYmpbIkF1dG8gV2QiXVsiVG9nZ2xlIl0gPT0gIk9uIiBvciBvYmpbIkF1dG8gV2QiXVsiVG9nZ2xlIl0gPT0gIk9OIiBvciBvYmpbIkF1dG8gV2QiXVsiVG9nZ2xlIl0gPT0gIm9uIjoNCiAgICAgICAgICAgaWYgZmxvYXQocmV2KHN0cihiYWwpKSkgPiBmbG9hdChvYmpbIkF1dG8gV2QiXVsiSWYgQmFsYW5jZSJdKToNCiAgICAgICAgICAgICAgd2QgPSB7DQogICAgICAgICAgICAgICAgImEiOiAiV2l0aGRyYXciLA0KICAgICAgICAgICAgICAgICJzIjoganNbIlNlc3Npb25Db29raWUiXSwNCiAgICAgICAgICAgICAgICAiQW1vdW50IjogaW50KGZsb2F0KG9ialsiQXV0byBXZCJdWyJBbW91bnQiXSkqKDEwICoqIDgpKSwNCiAgICAgICAgICAgICAgICAiQWRkcmVzcyI6IG9ialsiQXV0byBXZCJdWyJXYWxsZXQgQWRkcmVzcyJdLA0KICAgICAgICAgICAgICAgICJUb3RwIjogIiIsDQogICAgICAgICAgICAgICAgIkN1cnJlbmN5IjogImRvZ2UiDQoNCiAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICByMSA9IGMucG9zdCh1cmwsaGVhZGVycz11YSxkYXRhPXdkKQ0KICAgICAgICAgICAgICB3aXRoZHJhdyA9IGpzb24ubG9hZHMocjEudGV4dCkNCiAgICAgICAgICAgICAgcHJpbnQgKCIiKQ0KICAgICAgICAgICAgICBwcmludCAoIldpdGhkcmF3ICIrc3RyKHJldihzdHIod2l0aGRyYXdbIlBlbmRpbmciXSkpKSkNCiAgICAgICAgICAgICAgd2l0aCBvcGVuKCJoaXN0b3J5LmxvZyIsImErIikgYXMgZjoNCiAgICAgICAgICAgICAgICAgIGYud3JpdGUoIldpdGhkcmF3ICIrc3RyKHJldihzdHIod2l0aGRyYXdbIlBlbmRpbmciXSkpKSsiXG4iKQ0KICAgICAgICAgICAgICBzeXMuZXhpdCgpDQoNCg0KDQogICBleGNlcHQ6DQogICAgICAgcHJpbnQgKCIiKQ0KICAgICAgIG9zLnN5c3RlbSgidGVybXV4LXRvYXN0IEJldHRpbmcgU3RvcCIpDQogICAgICAgdHJ5Og0KICAgICAgICAgIHdpdGggb3BlbigiaGlzdG9yeS5sb2ciLCJhKyIpIGFzIGY6DQogICAgICAgICAgICAgIGYud3JpdGUoIlsiK2RhdGV0aW1lLm5vdygpLnN0cmZ0aW1lKCclWS8lbS8lZCAlSDolTTolUycpKyJdIFdpbiBTdHJlYWsgIitzdHIodG90YWxfd2luKSsiIExvc2UgU3RyZWFrICIrc3RyKHRvdGFsX2xvc2UpKyIgfCBCYWxhbmNlICIrc3RyKGZsb2F0KGludChqc25bIlN0YXJ0aW5nQmFsYW5jZSJdKSArIGludChqdW0pKS8oMTAgKiogOCkpKyIgUHJvZml0ICIrc3RyKHByb2YpKyJcbiIpDQogICAgICAgZXhjZXB0Og0KICAgICAgICAgIHByaW50IChyZWQyKyJCYWxhbmNlIE5vdCBFbm91Z2giKQ0KICAgICAgIHN5cy5leGl0KCkNCnIgPSBjLmdldCh1cmwsaGVhZGVycz11YSxkYXRhPXsiYSI6ICJMb2dpbiIsIktleSI6ICI3ZWM3ZjhhMmM5NzI0YjJjYmI4ZWQ3NWU3MmI0N2VlOSIsIlVzZXJuYW1lIjogb2JqWyJBY2NvdW50Il1bIlVzZXJuYW1lIl0sIlBhc3N3b3JkIjogb2JqWyJBY2NvdW50Il1bIlBhc3N3b3JkIl0sIlRvdHAiOiAiIn0pDQpqcyA9IGpzb24ubG9hZHMoci50ZXh0KQ0KdHJ5Og0KICBwcmludCAoaGlqYXUrIkJhbGFuY2UgIithYnUyKyI6ICIrcmVzK3N0cihmbG9hdChqc1siRG9nZSJdWyJCYWxhbmNlIl0pLygxMCAqKiA4KSkpDQpleGNlcHQ6DQogIHByaW50ICgiYm9zc2t1dXUuLi4gdXNlcm5hbWUgYXRhdSBwYXNzc3dvcmQgc2FsYWggbmkuLi4uLiIpDQogIHN5cy5leGl0KCkNCg0KDQpkaWNlKGludChmbG9hdChvYmpbIlRhcmdldCBXaW4iXSkqKDEwICoqIDgpKSxpbnQoZmxvYXQob2JqWyJMb3NlIFRhcmdldCJdKSooMTAgKiogOCkpKQ==+IGludChvYmpbIkNvbmZpZyJdW3VydXRdWyJCZXQiXVsiSGkgLyBMb3ciXVsiSWYgV2luIl0pIC0gMToKICAgICAgICAgICAgICAgICAgcm9sZWJldCA9ICJMbyIKICAgICAgICAgICAgICAgaWYgbm9fcm9sZWJldCA+IGludChvYmpbIkNvbmZpZyJdW3VydXRdWyJCZXQiXVsiSGkgLyBMb3ciXVsiSWYgV2luIl0pICogMiAtIDE6CiAgICAgICAgICAgICAgICAgIHJvbGViZXQgPSAiSGkiCiAgICAgICAgICAgICAgICAgIG5vX3JvbGViZXQgPSAwCiAgICAgICAgICAgIGlmIHN0YXRzX3JvbGViZXRfbG9zZSBpcyBUcnVlOgogICAgICAgICAgICAgICBpZiBub19yb2xlYmV0ID4gaW50KG9ialsiQ29uZmlnIl1bdXJ1dF1bIkJldCJdWyJIaSAvIExvdyJdWyJJZiBMb3NlIl0pIC0xIDoKICAgICAgICAgICAgICAgICAgcm9sZWJldCA9ICJMbyIKICAgICAgICAgICAgICAgaWYgbm9fcm9sZWJldCA+IGludChvYmpbIkNvbmZpZyJdW3VydXRdWyJCZXQiXVsiSGkgLyBMb3ciXVsiSWYgTG9zZSJdKSAqIDIgLSAxOgogICAgICAgICAgICAgICAgICByb2xlYmV0ID0gIkhpIgogICAgICAgICAgICAgICAgICBub19yb2xlYmV0ID0gMAogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHJvbGViZXQgPSBvYmpbIkNvbmZpZyJdW3VydXRdWyJCZXQiXVsiQmV0Il0KICAgICAgICBpZiBteV9uYW1lc3BhY2UuYmV0c2V0ID09ICJBdXRvIiBvciBteV9uYW1lc3BhY2UuYmV0c2V0ID09ICJBVVRPIiBvciBteV9uYW1lc3BhY2UuYmV0c2V0ID09ICJhdXRvIjoKICAgICAgICAgIHdha3R1ID0gZGF0ZXRpbWUubm93KCkuc3RyZnRpbWUoJyVNJykKICAgICAgICAgIGlmIGludCh3YWt0dSkgPiBpbnQobWVuaXQgLSAxKToKICAgICAgICAgICAgIG1lbml0ID0gaW50KG1lbml0KSArIGludChvYmpbIkludGVydmFsIl0pCiAgICAgICAgICAgICB1cnV0ICs9MQogICAgICAgICAgICAgaWYgdXJ1dCA9PSBqdW1sYWh1bGFuZzoKICAgICAgICAgICAgICAgIHVydXQgPSAwCiAgICAgICAgICAgICBwcmludCAoIkNoYW5nZSBCZXQgU2V0ICIrb2JqWyJDb25maWciXVt1cnV0XVsiTmFtZSBCZXQgU2V0Il0rIiAgICAgICAgICAgICAgICAgICAgICAgICAgICIpCiAgICAgICAgICAgICBzbHAgPSBpbnQob2JqWyJDb25maWciXVt1cnV0XVsiSW50ZXJ2YWwiXSkgLyAxMDAwCiAgICAgICAgICAgICBsaW1pdF9hID0gaW50KG9ialsiQ29uZmlnIl1bdXJ1dF1bIlJlc2V0IElmIFdpbiJdKSAtIDEKICAgICAgICAgICAgIHBheWluID0gaW50KGZsb2F0KG9ialsiQ29uZmlnIl1bdXJ1dF1bIkJhc2UgQmV0Il0pKigxMCAqKiA4KSkKICAgICAgICAgICAgIGFtb3VudCA9IHBheWluCgogICAgICAgIGVsc2U6CiAgICAgICAgICB1cnV0ID0gaW50KG15X25hbWVzcGFjZS5iZXRzZXQpCgogICAgICAgIGlmIG9ialsiQ29uZmlnIl1bdXJ1dF1bIlJhbmRvbSBDaGFuY2UiXVsiVG9nZ2xlIl0gPT0gIk9OIiBvciBvYmpbIkNvbmZpZyJdW3VydXRdWyJSYW5kb20gQ2hhbmNlIl1bIlRvZ2dsZSJdID09ICJPbiIgb3Igb2JqWyJDb25maWciXVt1cnV0XVsiUmFuZG9tIENoYW5jZSJdWyJUb2dnbGUiXSA9PSAib24iOgogICAgICAgICAgIGhhc2lsX2NoYW5jZSA9IHJvdW5kKHJhbmRvbS51bmlmb3JtKGZsb2F0KG9ialsiQ29uZmlnIl1bdXJ1dF1bIlJhbmRvbSBDaGFuY2UiXVsiTWluIl0pLGZsb2F0KG9ialsiQ29uZmlnIl1bdXJ1dF1bIlJhbmRvbSBDaGFuY2UiXVsiTWF4Il0pKSwyKQogICAgICAgICAgIGNvayA9IGxlbihzdHIoaGFzaWxfY2hhbmNlKSkKICAgICAgICAgICBpZiBjb2sgPT0gMzoKICAgICAgICAgICAgICBzeXMuc3Rkb3V0LndyaXRlKCJcciIrc3RyKGhhc2lsX2NoYW5jZSkrIiAgICIpCiAgICAgICAgICAgaWYgY29rID09IDQ6CiAgICAgICAgICAgICAgc3lzLnN0ZG91dC53cml0ZSgiXHIiK3N0cihoYXNpbF9jaGFuY2UpKyIgICIpCiAgICAgICAgICAgaWYgY29rID09IDU6CiAgICAgICAgICAgICAgc3lzLnN0ZG91dC53cml0ZSgiXHIiK3N0cihoYXNpbF9jaGFuY2UpKyIgIikKICAgICAgICAgICBrb252ZXJ0KGhhc2lsX2NoYW5jZSxzdHIocm9sZWJldCkpCiAgICAgICAgZWxzZToKICAgICAgICAgICBrb252ZXJ0KG9ialsiQ29uZmlnIl1bdXJ1dF1bIkNoYW5jZSJdLHN0cihyb2xlYmV0KSkKCiAgICAgICAgdGltZS5zbGVlcChmbG9hdChzbHApKQogICAgICAgIGFtb3VudCA9IGludChhbW91bnQpCiAgICAgICAgbis9MQogICAgICAgIGRhdGEgPSB7CiAgICAgICAgICAiYSI6ICJQbGFjZUJldCIsCiAgICAgICAgICAicyI6IGpzWyJTZXNzaW9uQ29va2llIl0sCiAgICAgICAgICAiUGF5SW4iOiBhbW91bnQsCiAgICAgICAgICAiTG93IjogbG93LAogICAgICAgICAgIkhpZ2giOiBoaWdoLAogICAgICAgICAgIkNsaWVudFNlZWQiOiByYW5kaW50KDAsOTk5OTk5KSwKICAgICAgICAgICJDdXJyZW5jeSI6ICJkb2dlIiwKICAgICAgICAgICJQcm90b2NvbFZlcnNpb24iOiAiMiIKICAgICAgICB9CiAgICAgICAgaWYgcHJvZiA+IGZsb2F0KG9ialsiVGFyZ2V0IFByb2ZpdCJdKToKICAgICAgICAgICBwcmludCAoaGlqYXUrIlxuWWF5LiEgXG5Qcm9maXQgTWVuY2FwYWkgVGFyZ2V0Li4uLi4hXG4iK2hpamF1KyJQcm9maXQgIityZXMrc3RyKHByb2YpKQogICAgICAgICAgIG9zLnN5c3RlbSgidGVybXV4LXRvYXN0IFlvdSB3aW4gIitzdHIocHJvZikpCiAgICAgICAgICAgdGltZS5zbGVlcCgxKQogICAgICAgICAgIG9zLnN5c3RlbSgidGVybXV4LXRvYXN0IFRvdGFsIEJhbGFuY2UgIitzdHIoZmxvYXQoaW50KGpzblsiU3RhcnRpbmdCYWxhbmNlIl0pICsgaW50KGp1bSkpLygxMCAqKiA4KSkpCiAgICAgICAgICAgc3lzLmV4aXQoKQogICAgICAgIHIxID0gYy5wb3N0KHVybCxoZWFkZXJzPXVhLGRhdGE9ZGF0YSkKICAgICAgICBqc24gPSBqc29uLmxvYWRzKHIxLnRleHQpCiAgICAgICAgcHJvZiA9IChmbG9hdChqc25bIlN0YXJ0aW5nQmFsYW5jZSJdICsgaW50KGpzblsiUGF5T3V0Il0pIC0gaW50KGFtb3VudCkgLSBqdW1ibCkvKDEwICoqIDgpKQogICAgICAgIGp1bSA9IGludChqc25bIlBheU91dCJdKSAtIGludChhbW91bnQpCiAgICAgICAgaWYganNuWyJTdGFydGluZ0JhbGFuY2UiXSA+IHdzOgogICAgICAgICAgIHByaW50ICh1bmd1KyJbIityZXMrc3RyKHJvbGViZXQpK3VuZ3UrIl0gIitoaWphdTIrc3RyKGZsb2F0KGFtb3VudCkvKDEwICoqIDgpKSxyZXMrc3RyKGZsb2F0KGludChqc25bIlN0YXJ0aW5nQmFsYW5jZSJdKSArIGludChqdW0pKS8oMTAgKiogOCkpLGhpamF1MisiUHJvZml0IixyZXMrc3RyKHByb2YpKQogICAgICAgICAgIHByaW50IChoaWphdSsiWWF5LiFcbkJhbGFuY2UgU3VkYWggTWVtZW51aGkgVGFyZ2V0Li4uLi4hIikKICAgICAgICAgICBvcy5zeXN0ZW0oInRlcm11eC10b2FzdCBUYXJnZXQgV2luIFN1ZGFoIFRlcmNhcGFpIikKICAgICAgICAgICB0aW1lLnNsZWVwKDEpCiAgICAgICAgICAgb3Muc3lzdGVtKCJ0ZXJtdXgtdG9hc3QgVG90YWwgQmFsYW5jZSAiK3N0cihmbG9hdChpbnQoanNuWyJTdGFydGluZ0JhbGFuY2UiXSkgKyBpbnQoanVtKSkvKDEwICoqIDgpKSkKICAgICAgICAgICBzeXMuZXhpdCgpCiAgICAgICAgaWYganNuWyJTdGFydGluZ0JhbGFuY2UiXSA8IGxzOgogICAgICAgICAgIHByaW50ICh1bmd1KyJbIityZXMrc3RyKHJvbGViZXQpK3VuZ3UrIl0iK3JlZDIrIi0iK3N0cihmbG9hdChhbW91bnQpLygxMCAqKiA4KSkscmVzK3N0cigoZmxvYXQoaW50KGpzblsiU3RhcnRpbmdCYWxhbmNlIl0pICsgaW50KGp1bSkpLygxMCAqKiA4KSkpLHJlZDIrIkxvc2UgIixyZXMrc3RyKHByb2YpKQogICAgICAgICAgIHByaW50IChTdHlsZS5CUklHSFQrRm9yZS5SRUQrIkxvc2UgVGFyZ2V0Li4uLiEiKQogICAgICAgICAgIG9zLnN5c3RlbSgidGVybXV4LXRvYXN0IExvc2UgVGFyZ2V0ICIpCiAgICAgICAgICAgdGltZS5zbGVlcCgxKQogICAgICAgICAgIG9zLnN5c3RlbSgidGVybXV4LXRvYXN0IFRvdGFsIEJhbGFuY2UgIitzdHIoZmxvYXQoaW50KGpzblsiU3RhcnRpbmdCYWxhbmNlIl0pICsgaW50KGp1bSkpLygxMCAqKiA4KSkpCiAgICAgICAgICAgc3lzLmV4aXQoKQogICAgICAgIGlmIGpzblsiUGF5T3V0Il0gaXMgbm90IDA6CiAgICAgICAgICAgbm9fd2luICs9MQogICAgICAgICAgIG5vX2xvc2UgPSAwCiAgICAgICAgICAgYmFsID0gaW50KGpzblsiU3RhcnRpbmdCYWxhbmNlIl0pICsgaW50KGp1bSkKICAgICAgICAgICBpZiBwcm9mID4gMDoKICAgICAgICAgICAgIHByaW50ICh1bmd1KyJbIityZXMrc3RyKHJvbGViZXQpK3VuZ3UrIl0gIitoaWphdTIrc3RyKHJldihzdHIoYW1vdW50KSkpLHJlcytzdHIocmV2KHN0cihiYWwpKSksaGlqYXUyKyJQcm9maXQiLHJlcytzdHIocHJvZikpCiAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgIHByaW50ICh1bmd1KyJbIityZXMrc3RyKHJvbGViZXQpK3VuZ3UrIl0gIitoaWphdTIrc3RyKHJldihzdHIoYW1vdW50KSkpLHJlcytzdHIocmV2KHN0cihiYWwpKSkscmVkMisiTG9zZSAiLHJlcytzdHIocHJvZikpCiAgICAgICAgICAgYW1vdW50ID0gaW50KGFtb3VudCkgKiBmbG9hdChvYmpbIkNvbmZpZyJdW3VydXRdWyJJZiBXaW4iXSkKCiAgICAgICAgZWxzZToKICAgICAgICAgICBub193aW4gPSAwCiAgICAgICAgICAgbm9fbG9zZSArPTEKICAgICAgICAgICBpID0gMAogICAgICAgICAgIGJ1cnN0ID0gVHJ1ZQogICAgICAgICAgIGJhbCA9IGludChqc25bIlN0YXJ0aW5nQmFsYW5jZSJdKSArIGludChqdW0pCiAgICAgICAgICAgaWYgcHJvZiA+IDA6CiAgICAgICAgICAgICBwcmludCAodW5ndSsiWyIrcmVzK3N0cihyb2xlYmV0KSt1bmd1KyJdIityZWQyKyItIitzdHIocmV2KHN0cihhbW91bnQpKSkscmVzK3N0cihyZXYoc3RyKGJhbCkpKSxoaWphdTIrIlByb2ZpdCIscmVzK3N0cihwcm9mKSkKICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgcHJpbnQgKHVuZ3UrIlsiK3JlcytzdHIocm9sZWJldCkrdW5ndSsiXSIrcmVkMisiLSIrc3RyKHJldihzdHIoYW1vdW50KSkpLHJlcytzdHIocmV2KHN0cihiYWwpKSkscmVkMisiTG9zZSAiLHJlcytzdHIocHJvZikpCiAgICAgICAgICAgYW1vdW50ID0gaW50KGFtb3VudCkgKiBmbG9hdChvYmpbIkNvbmZpZyJdW3VydXRdWyJJZiBMb3NlIl0pCiAgICAgICAgaWYgc3RhdHNfaWZfcHJvZml0IGlzIFRydWU6CiAgICAgICAgICAgIGlmIHByb2YgPiBmbG9hdChyZXNldF9pZl9wcm9maXQpOgogICAgICAgICAgICAgICBhbW91bnQgPSBwYXlpbgogICAgICAgICAgICAgICByZXNldF9pZl9wcm9maXQgPSBmbG9hdChwcm9mKStmbG9hdCh0b3RfaWZfcHJvZml0KQoKICAgICAgICBpZiBidXJzdCBpcyBUcnVlOgogICAgICAgICAgIGkrPTEKICAgICAgICAgICBpZiBpID4gbGltaXRfYToKICAgICAgICAgICAgIGkgPSAwCiAgICAgICAgICAgICBidXJzdCA9IEZhbHNlCiAgICAgICAgZWxzZToKICAgICAgICAgICBpZiBuID4gbGltaXRfYToKICAgICAgICAgICAgIG4gPSAwCiAgICAgICAgICAgICBhbW91bnQgPSBwYXlpbgoKICAgICAgICBpZiBub193aW4gPiB0b3RhbF93aW46CiAgICAgICAgICAgc3RhdHNfcm9sZWJldF93aW4gPSBUcnVlCiAgICAgICAgICAgc3RhdHNfcm9sZWJldF9sb3NlID0gRmFsc2UKICAgICAgICAgICB0b3RhbF93aW4gKz0xCiAgICAgICAgaWYgbm9fbG9zZSA+IHRvdGFsX2xvc2U6CiAgICAgICAgICAgc3RhdHNfcm9sZWJldF9sb3NlID0gVHJ1ZQogICAgICAgICAgIHN0YXRzX3JvbGViZXRfd2luID0gRmFsc2UKICAgICAgICAgICB0b3RhbF9sb3NlICs9MQogICAgICAgIHN5cy5zdGRvdXQud3JpdGUoaGlqYXUrIiAgICAgICAgV2luIFN0cmVhayAiK3JlcytzdHIodG90YWxfd2luKStyZWQrIiBMb3NlIFN0cmVhayAiK3JlcytzdHIodG90YWxfbG9zZSkrIlxyIikKICAgICAgICBpZiBvYmpbIkF1dG8gV2QiXVsiVG9nZ2xlIl0gPT0gIk9uIiBvciBvYmpbIkF1dG8gV2QiXVsiVG9nZ2xlIl0gPT0gIk9OIiBvciBvYmpbIkF1dG8gV2QiXVsiVG9nZ2xlIl0gPT0gIm9uIjoKICAgICAgICAgICBpZiBmbG9hdChyZXYoc3RyKGJhbCkpKSA+IGZsb2F0KG9ialsiQXV0byBXZCJdWyJJZiBCYWxhbmNlIl0pOgogICAgICAgICAgICAgIHdkID0gewogICAgICAgICAgICAgICAgImEiOiAiV2l0aGRyYXciLAogICAgICAgICAgICAgICAgInMiOiBqc1siU2Vzc2lvbkNvb2tpZSJdLAogICAgICAgICAgICAgICAgIkFtb3VudCI6IGludChmbG9hdChvYmpbIkF1dG8gV2QiXVsiQW1vdW50Il0pKigxMCAqKiA4KSksCiAgICAgICAgICAgICAgICAiQWRkcmVzcyI6IG9ialsiQXV0byBXZCJdWyJXYWxsZXQgQWRkcmVzcyJdLAogICAgICAgICAgICAgICAgIlRvdHAiOiAiIiwKICAgICAgICAgICAgICAgICJDdXJyZW5jeSI6ICJkb2dlIgoKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgcjEgPSBjLnBvc3QodXJsLGhlYWRlcnM9dWEsZGF0YT13ZCkKICAgICAgICAgICAgICB3aXRoZHJhdyA9IGpzb24ubG9hZHMocjEudGV4dCkKICAgICAgICAgICAgICBwcmludCAoIiIpCiAgICAgICAgICAgICAgcHJpbnQgKCJXaXRoZHJhdyAiK3N0cihyZXYoc3RyKHdpdGhkcmF3WyJQZW5kaW5nIl0pKSkpCiAgICAgICAgICAgICAgd2l0aCBvcGVuKCJoaXN0b3J5LmxvZyIsImErIikgYXMgZjoKICAgICAgICAgICAgICAgICAgZi53cml0ZSgiV2l0aGRyYXcgIitzdHIocmV2KHN0cih3aXRoZHJhd1siUGVuZGluZyJdKSkpKyJcbiIpCiAgICAgICAgICAgICAgc3lzLmV4aXQoKQoKCgogICBleGNlcHQ6CiAgICAgICBwcmludCAoIiIpCiAgICAgICBvcy5zeXN0ZW0oInRlcm11eC10b2FzdCBCZXR0aW5nIFN0b3AiKQogICAgICAgdHJ5OgogICAgICAgICAgd2l0aCBvcGVuKCJoaXN0b3J5LmxvZyIsImErIikgYXMgZjoKICAgICAgICAgICAgICBmLndyaXRlKCJbIitkYXRldGltZS5ub3coKS5zdHJmdGltZSgnJVkvJW0vJWQgJUg6JU06JVMnKSsiXSBXaW4gU3RyZWFrICIrc3RyKHRvdGFsX3dpbikrIiBMb3NlIFN0cmVhayAiK3N0cih0b3RhbF9sb3NlKSsiIHwgQmFsYW5jZSAiK3N0cihmbG9hdChpbnQoanNuWyJTdGFydGluZ0JhbGFuY2UiXSkgKyBpbnQoanVtKSkvKDEwICoqIDgpKSsiIFByb2ZpdCAiK3N0cihwcm9mKSsiXG4iKQogICAgICAgZXhjZXB0OgogICAgICAgICAgcHJpbnQgKHJlZDIrIkJhbGFuY2UgTm90IEVub3VnaCIpCiAgICAgICBzeXMuZXhpdCgpCnIgPSBjLmdldCh1cmwsaGVhZGVycz11YSxkYXRhPXsiYSI6ICJMb2dpbiIsIktleSI6ICI3ZWM3ZjhhMmM5NzI0YjJjYmI4ZWQ3NWU3MmI0N2VlOSIsIlVzZXJuYW1lIjogb2JqWyJBY2NvdW50Il1bIlVzZXJuYW1lIl0sIlBhc3N3b3JkIjogb2JqWyJBY2NvdW50Il1bIlBhc3N3b3JkIl0sIlRvdHAiOiAiIn0pCmpzID0ganNvbi5sb2FkcyhyLnRleHQpCnRyeToKICBwcmludCAoaGlqYXUrIkJhbGFuY2UgIithYnUyKyI6ICIrcmVzK3N0cihmbG9hdChqc1siRG9nZSJdWyJCYWxhbmNlIl0pLygxMCAqKiA4KSkpCmV4Y2VwdDoKICBwcmludCAoIkNoZWNrIFlvdXIgVXNlcm5hbWUgQW5kIFlvdXIgUGFzc3dvcmQiKQogIHN5cy5leGl0KCkKCgpkaWNlKGludChmbG9hdChvYmpbIlRhcmdldCBXaW4iXSkqKDEwICoqIDgpKSxpbnQoZmxvYXQob2JqWyJMb3NlIFRhcmdldCJdKSooMTAgKiogOCkpKQ=="))
